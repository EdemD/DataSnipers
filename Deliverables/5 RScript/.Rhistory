library("dplyr")
View(cst_trendL)
?mutate
attach(cst_trendL)
View(cst_trendL)
y  = data.frame(category=c(1,1,1,1,2,2,2,2), value=c(2,2,1,1,2,2,2,1))
data.m = melt(table(y))
names(data.m)[3] = "count"
View(y)
View(data.m)
# calculate percentage:
m1 = ddply(data.m, .(category), summarize, ratio=count/sum(count))
library(ddply)
install.packages("ddply")
library(ddply)
library(plyr)
# calculate percentage:
m1 = ddply(data.m, .(category), summarize, ratio=count/sum(count))
View(m1)
View(cst_trendL)
cst_trendL %>%
group_by(year) %>%
mutate(countT=sum(count)) %>%
group_by(type, add=TRUE) %>%
mutate(per=paste0(round(100*count/countT, 2), "%"))
View(cst_trendL)
cst_trendL %>% group_by(year) %>%
mutate(per=paste0(round(count/sum(count*100)),2), "%") %>%
ungroup
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(mfrow=c(1,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
knitr::opts_chunk$set(echo = TRUE)
cst <- read.csv("src/Comprehensive Species Tally 1937-2016.csv", na.strings = "na")
cst <- cst[,-c(2,3,4)]
head(cst)
restoration <- read.csv("src/NYBG Forest Restoration Plantings 2007-2018.csv")
restoration <- restoration[,-c(1,6,7,9)]
head(restoration)
cst$Survey.Year <- factor(cst$Survey.Year)
summary(cst)
# Trying Tidyverse
cst %>%
group_by(cst$Survey.Year)
#Create sub-tables
cst_1937 <- subset(cst, cst$Survey.Year==1937)
cst_2002 <- subset(cst, cst$Survey.Year==2002)
cst_2006 <- subset(cst, cst$Survey.Year==2006)
cst_2011 <- subset(cst, cst$Survey.Year==2011)
cst_2016 <- subset(cst, cst$Survey.Year==2016)
# Create vectors for all the years and species -> native, not-native and invasive
year <- c('1937-01-01', '2002-01-01', '2006-01-01', '2011-01-01', '2016-01-01')
year <- as.Date(year)
native <- c(length(which(cst_1937$Native=='y')), length(which(cst_2002$Native=='y')), length(which(cst_2006$Native=='y')), length(which(cst_2011$Native=='y')), length(which(cst_2016$Native=='y')))
non_native <- c(length(which(cst_1937$Non.native=='y')), length(which(cst_2002$Non.native=='y')), length(which(cst_2006$Non.native=='y')), length(which(cst_2011$Non.native=='y')), length(which(cst_2016$Non.native=='y')))
invasive <- c(length(which(cst_1937$Invasive=='y')), length(which(cst_2002$Invasive=='y')), length(which(cst_2006$Invasive=='y')), length(which(cst_2011$Invasive=='y')), length(which(cst_2016$Invasive=='y')))
#Create dataframe with the vectors
cst_trend <- data.frame(year, native, non_native, invasive, stringsAsFactors = FALSE)
head(cst_trend)
#Reshaping the dataframe
library(reshape2)
cst_trendL <- melt(cst_trend, id.vars = c("year"))
colnames(cst_trendL)[2] <- "type"
colnames(cst_trendL)[3] <- "count"
#Plotting the dataset
library(ggplot2)
line <- ggplot(cst_trendL, aes(x = year, y = count, color = type)) + geom_line(size=1) + geom_point(size=2)+ ggtitle("Species Count from 1937 to 2016") + labs(x="Years", y="Species Count")
line <- line + theme_bw()
line
line <- ggplot(cst_trendL[cst_trendL$year >= "2002-01-01",], aes(x = year, y = count, color = type)) + geom_line(size=1) + geom_point(size=2) + ggtitle("Species Count from 2002 to 2016") + labs(x="Years", y="Species Count")
line <- line + theme_bw()
line
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(mfrow=c(1,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
getwd()
setwd("C:/Users/Vikash Kumar/OneDrive/UNOmaha/Study/Sem 3/ISQA 8086 - 2/NY Botanical Garden/1 - Work/DataSnipers/Deliverables/5 RScript")
getwd()
knitr::opts_chunk$set(echo = TRUE)
cst <- read.csv("src/Comprehensive Species Tally 1937-2016.csv", na.strings = "na")
cst <- cst[,-c(2,3,4)]
head(cst)
restoration <- read.csv("src/NYBG Forest Restoration Plantings 2007-2018.csv")
restoration <- restoration[,-c(1,6,7,9)]
head(restoration)
cst$Survey.Year <- factor(cst$Survey.Year)
summary(cst)
# Trying Tidyverse
cst %>%
group_by(cst$Survey.Year)
knitr::opts_chunk$set(echo = TRUE)
cst <- read.csv("src/Comprehensive Species Tally 1937-2016.csv", na.strings = "na")
cst <- cst[,-c(2,3,4)]
head(cst)
restoration <- read.csv("src/NYBG Forest Restoration Plantings 2007-2018.csv")
restoration <- restoration[,-c(1,6,7,9)]
head(restoration)
cst$Survey.Year <- factor(cst$Survey.Year)
summary(cst)
#Create sub-tables
cst_1937 <- subset(cst, cst$Survey.Year==1937)
cst_2002 <- subset(cst, cst$Survey.Year==2002)
cst_2006 <- subset(cst, cst$Survey.Year==2006)
cst_2011 <- subset(cst, cst$Survey.Year==2011)
cst_2016 <- subset(cst, cst$Survey.Year==2016)
# Create vectors for all the years and species -> native, not-native and invasive
year <- c('1937-01-01', '2002-01-01', '2006-01-01', '2011-01-01', '2016-01-01')
year <- as.Date(year)
native <- c(length(which(cst_1937$Native=='y')), length(which(cst_2002$Native=='y')), length(which(cst_2006$Native=='y')), length(which(cst_2011$Native=='y')), length(which(cst_2016$Native=='y')))
non_native <- c(length(which(cst_1937$Non.native=='y')), length(which(cst_2002$Non.native=='y')), length(which(cst_2006$Non.native=='y')), length(which(cst_2011$Non.native=='y')), length(which(cst_2016$Non.native=='y')))
invasive <- c(length(which(cst_1937$Invasive=='y')), length(which(cst_2002$Invasive=='y')), length(which(cst_2006$Invasive=='y')), length(which(cst_2011$Invasive=='y')), length(which(cst_2016$Invasive=='y')))
#Create dataframe with the vectors
cst_trend <- data.frame(year, native, non_native, invasive, stringsAsFactors = FALSE)
head(cst_trend)
#Reshaping the dataframe
library(reshape2)
cst_trendL <- melt(cst_trend, id.vars = c("year"))
colnames(cst_trendL)[2] <- "type"
colnames(cst_trendL)[3] <- "count"
#Plotting the dataset
library(ggplot2)
line <- ggplot(cst_trendL, aes(x = year, y = count, color = type)) + geom_line(size=1) + geom_point(size=2)+ ggtitle("Species Count from 1937 to 2016") + labs(x="Years", y="Species Count")
line <- line + theme_bw()
line
line <- ggplot(cst_trendL[cst_trendL$year >= "2002-01-01",], aes(x = year, y = count, color = type)) + geom_line(size=1) + geom_point(size=2) + ggtitle("Species Count from 2002 to 2016") + labs(x="Years", y="Species Count")
line <- line + theme_bw()
line
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(mfrow=c(1,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
?par
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(oma=c(0,0,2,0), mfrow=c(1,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(oma=c(0,2,2,2), mfrow=c(1,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
png(height=300, width=600);par(oma=c(0,0,2,0), mfrow=c(1,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
png(height=300, width=600);par(oma=c(0,0,2,0), mfrow=c(1,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
layout.show()
layout.show(n=3)
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(oma=c(0,0,2,0), mfrow=c(1,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(oma=c(0,0,2,0), mfrow=c(1,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
?par
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(mar=c(8, 8, 8, 8), oma=c(0,0,2,0), mfrow=c(1,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(mar=c(5, 5, 5, 5), oma=c(0,0,2,0), mfrow=c(1,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
View(cst_trendL)
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(mar=c(5, 5, 5, 5), oma=c(0,0,2,0), mfrow=c(2,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2011
count_2011 <- cst_trendL[cst_trendL$year == "2011-01-01",-c(1)]
slices <- count_2011$count
labels <-  count_2011$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2011", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2016
count_2016 <- cst_trendL[cst_trendL$year == "2016-01-01",-c(1)]
slices <- count_2016$count
labels <-  count_2016$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2016", col=brewer.pal(length(labels),"Pastel1"))
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(oma=c(0,0,2,0), mfrow=c(2,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2011
count_2011 <- cst_trendL[cst_trendL$year == "2011-01-01",-c(1)]
slices <- count_2011$count
labels <-  count_2011$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2011", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2016
count_2016 <- cst_trendL[cst_trendL$year == "2016-01-01",-c(1)]
slices <- count_2016$count
labels <-  count_2016$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2016", col=brewer.pal(length(labels),"Pastel1"))
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(mar=c(0, 0, 2, 0), oma=c(0,0,2,0), mfrow=c(2,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2011
count_2011 <- cst_trendL[cst_trendL$year == "2011-01-01",-c(1)]
slices <- count_2011$count
labels <-  count_2011$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2011", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2016
count_2016 <- cst_trendL[cst_trendL$year == "2016-01-01",-c(1)]
slices <- count_2016$count
labels <-  count_2016$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2016", col=brewer.pal(length(labels),"Pastel1"))
knitr::opts_chunk$set(echo = TRUE)
cst <- read.csv("src/Comprehensive Species Tally 1937-2016.csv", na.strings = "na")
cst <- cst[,-c(2,3,4)]
head(cst)
restoration <- read.csv("src/NYBG Forest Restoration Plantings 2007-2018.csv")
restoration <- restoration[,-c(1,6,7,9)]
head(restoration)
cst$Survey.Year <- factor(cst$Survey.Year)
summary(cst)
#Create sub-tables
cst_1937 <- subset(cst, cst$Survey.Year==1937)
cst_2002 <- subset(cst, cst$Survey.Year==2002)
cst_2006 <- subset(cst, cst$Survey.Year==2006)
cst_2011 <- subset(cst, cst$Survey.Year==2011)
cst_2016 <- subset(cst, cst$Survey.Year==2016)
# Create vectors for all the years and species -> native, not-native and invasive
year <- c('1937-01-01', '2002-01-01', '2006-01-01', '2011-01-01', '2016-01-01')
year <- as.Date(year)
native <- c(length(which(cst_1937$Native=='y')), length(which(cst_2002$Native=='y')), length(which(cst_2006$Native=='y')), length(which(cst_2011$Native=='y')), length(which(cst_2016$Native=='y')))
non_native <- c(length(which(cst_1937$Non.native=='y')), length(which(cst_2002$Non.native=='y')), length(which(cst_2006$Non.native=='y')), length(which(cst_2011$Non.native=='y')), length(which(cst_2016$Non.native=='y')))
invasive <- c(length(which(cst_1937$Invasive=='y')), length(which(cst_2002$Invasive=='y')), length(which(cst_2006$Invasive=='y')), length(which(cst_2011$Invasive=='y')), length(which(cst_2016$Invasive=='y')))
#Create dataframe with the vectors
cst_trend <- data.frame(year, native, non_native, invasive, stringsAsFactors = FALSE)
head(cst_trend)
#Reshaping the dataframe
library(reshape2)
cst_trendL <- melt(cst_trend, id.vars = c("year"))
colnames(cst_trendL)[2] <- "type"
colnames(cst_trendL)[3] <- "count"
#Plotting the dataset
library(ggplot2)
line <- ggplot(cst_trendL, aes(x = year, y = count, color = type)) + geom_line(size=1) + geom_point(size=2)+ ggtitle("Species Count from 1937 to 2016") + labs(x="Years", y="Species Count")
line <- line + theme_bw()
line
line <- ggplot(cst_trendL[cst_trendL$year >= "2002-01-01",], aes(x = year, y = count, color = type)) + geom_line(size=1) + geom_point(size=2) + ggtitle("Species Count from 2002 to 2016") + labs(x="Years", y="Species Count")
line <- line + theme_bw()
line
#Getting some colors
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
par(mar=c(0, 0, 2, 0), oma=c(0,0,2,0), mfrow=c(2,2))
#Creating the pie for the year 2002
count_2002 <- cst_trendL[cst_trendL$year == "2002-01-01",-c(1)]
slices <- count_2002$count
labels <-  count_2002$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2002", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2006
count_2006 <- cst_trendL[cst_trendL$year == "2006-01-01",-c(1)]
slices <- count_2006$count
labels <-  count_2006$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2006", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2011
count_2011 <- cst_trendL[cst_trendL$year == "2011-01-01",-c(1)]
slices <- count_2011$count
labels <-  count_2011$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2011", col=brewer.pal(length(labels),"Pastel1"))
#Creating pie for 2016
count_2016 <- cst_trendL[cst_trendL$year == "2016-01-01",-c(1)]
slices <- count_2016$count
labels <-  count_2016$type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Percentage of species type in 2016", col=brewer.pal(length(labels),"Pastel1"))
