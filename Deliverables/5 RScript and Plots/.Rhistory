mutate(month2_planted = as.Date(paste0("2000-", month_planted, "-01"), "%Y-%m-%d"))
#Plotting the new dataset
res_month %>%
ggplot(aes(x=month2_planted, y=Qty)) +
geom_bar(stat = "identity", fill = "darkorchid4") +
facet_wrap(~year_planted, ncol = 3) +
labs(title="Plantations by Months/Year", x="Month", y="Quantity planted")+
theme_bw(base_size = 10) + scale_x_date(date_labels = "%b")
# Removing duplicates from Comprehensive Speices Tally
cst_dedup <- cst[!duplicated(cst$Taxon),]
# Left Joining Restoration Data with Comprehensive Species Tally
res_by_species <- restoration %>%
left_join(cst_dedup)
res_by_species <- na.omit(res_by_species)
summary(res_by_species)
res_native <- res_by_species[, c(1, 5)]
# Summarizing by year
res_native_by_year <- res_native %>%
group_by(year_planted) %>%
summarise(qty_planted = sum(Qty))
#Plotting
res_native_by_year[res_native_by_year$year_planted<2017,] %>%
ggplot(aes(x=year_planted, y=qty_planted)) +
geom_bar(stat = "identity", fill = "darkorchid4")
woody_plants = read.csv("src/inventory/woodyplant 1937-2016.csv", na.strings = "#N/A")
woody_plants <- na.omit(woody_plants)
woody_plants <- woody_plants[,-c(2,3)]
woody_plants_1937 <- subset(woody_plants, woody_plants$Year==1937)
woody_plants_2002 <- subset(woody_plants, woody_plants$Year==2002)
woody_plants_2006 <- subset(woody_plants, woody_plants$Year==2006)
woody_plants_2011 <- subset(woody_plants, woody_plants$Year==2011)
woody_plants_2016 <- subset(woody_plants, woody_plants$Year==2016)
# Create vectors for all the years and species -> native, not-native and invasive
#year <- c('1937-01-01', '2002-01-01', '2006-01-01', '2011-01-01', '2016-01-01')
#year <- as.Date(year)
year <- c(1937, 2002, 2006, 2011, 2016)
native <- c(length(which(woody_plants_1937$Native=='y')), length(which(woody_plants_2002$Native=='y')), length(which(woody_plants_2006$Native=='y')), length(which(woody_plants_2011$Native=='y')), length(which(woody_plants_2016$Native=='y')))
non_native <- c(length(which(woody_plants_1937$Non.native=='y')), length(which(woody_plants_2002$Non.native=='y')), length(which(woody_plants_2006$Non.native=='y')), length(which(woody_plants_2011$Non.native=='y')), length(which(woody_plants_2016$Non.native=='y')))
invasive <- c(length(which(woody_plants_1937$Invasive=='y')), length(which(woody_plants_2002$Invasive=='y')), length(which(woody_plants_2006$Invasive=='y')), length(which(woody_plants_2011$Invasive=='y')), length(which(woody_plants_2016$Invasive=='y')))
#Create dataframe with the vectors
woody_plants_trend <- data.frame(year, native, non_native, invasive, stringsAsFactors = FALSE)
head(woody_plants_trend)
woody_plants_trendL <- melt(woody_plants_trend, id.vars = c("year"))
colnames(woody_plants_trendL)[2] <- "type"
colnames(woody_plants_trendL)[3] <- "count"
woody_plants_trendL[year != 1937,] %>%
ggplot(aes(x = year, y = count, color = type)) +
geom_line(size=1) + geom_point(size=2) +
ggtitle("Woody Plants Count from 2002 to 2016") + labs(x="Years", y="Count") +
theme_bw()
gc_plants = read.csv("src/inventory/groundcover 2011-2016.csv", na.strings = "#N/A")
gc_plants <- na.omit(gc_plants)
gc_plants <- gc_plants[,-c(2,3)]
summary(gc_plants)
gc_native_summary <- gc_plants[gc_plants$Native == 'y',] %>%
group_by(Year) %>%
summarise(native = sum(Sum.of.Cover..cm.)) %>%
arrange(desc(native))
gc_non_native_summary <- gc_plants[gc_plants$Non.native == 'y',] %>%
group_by(Year) %>%
summarise(non_native = sum(Sum.of.Cover..cm.)) %>%
arrange(desc(non_native))
gc_invasive_summary <- gc_plants[gc_plants$Invasive == 'y',] %>%
group_by(Year) %>%
summarise(invasive = sum(Sum.of.Cover..cm.)) %>%
arrange(desc(invasive))
#Left joining the above three
gc_summary <- gc_native_summary %>%
left_join(gc_non_native_summary) %>%
left_join(gc_invasive_summary)
#Reshaping the dataframe for a more plot friendly form
gc_summary <- melt(gc_summary, id.vars = c("Year"))
colnames(gc_summary)[2] <- "species_type"
colnames(gc_summary)[3] <- "ground_cover"
gc_summary$ground_cover <- gc_summary$ground_cover/100
#Plotting the above using line chart
gc_summary %>%
ggplot(aes(x=Year, y=ground_cover, color=species_type)) +
geom_line(size=1) +
geom_point(size=2) +
labs(y= "Ground Cover in meters", title = "Ground Cover by Species Type")
woodyplants <- read_xlsx("src/Combined Woody Plants Data (2002,2006,2011,2016).xlsx")
groundcover <- read.csv("src/Combined Groundcover2011_2016.csv", stringsAsFactors = FALSE)
head(woodyplants)
tail(woodyplants)
str(woodyplants)
summary(woodyplants)
head(groundcover)
tail(groundcover)
str(groundcover)
summary(groundcover)
##forestmgmt <- read_xls("NYBG Forest Management_11052008 to 12312014.xls")
## First We are checking if there are any missing year column which is the first column on the datasets
sum(is.na(woodyplants$Year))
sum(is.na(groundcover$Sample.Date))
## Removing the empty rows
woodyplants <- woodyplants[rowSums(is.na(woodyplants)) < 7,]
groundcover <- groundcover[rowSums(is.na(groundcover)) < 10,]
woodyplants$`Transect Number` <- as.factor(woodyplants$`Transect Number`)
woodyplants$`Plot Number` <- as.factor(woodyplants$`Plot Number`)
groundcover$Transect.Number <- as.factor(groundcover$Transect.Number)
groundcover$Plot.Number <- as.factor(groundcover$Plot.Number)
groundcover$Sample.Date <- as.Date(groundcover$Sample.Date, format = "%m/%d/%Y")
#Set all the values in Genus to uppercases
woodyplants$Genus <- toupper(woodyplants$Genus)
library(dplyr)
#Get top 7 Genus
top_7 <- woodyplants %>% count(Genus) %>% arrange(desc(n)) %>% filter(n > 1000)
#Create a vector with top 7 Genus
target <- c("PRUNUS","DEAD","LINDERA","ACER","ARALIA","FAGUS","VIBURNUM")
#Get top 7 Genus with Year
top_7_year <- woodyplants %>% count(Year,Genus) %>% arrange(desc(n)) %>% filter(Genus %in% target )
#Create plots
library(ggplot2)
ggplot(top_7_year, aes(x = Genus, y = n, fill = factor(Year)), position ="dodge") + geom_bar(stat = "identity")
ggplot(top_7_year, aes(x = Genus, y = n, fill = factor(Year)), position ="dodge") + geom_bar(stat = "identity", position = "dodge")
as_plants = read.csv("additionalspecies 2011-2016.csv", na.strings = "#N/A")
setwd("C:/Users/Vikash Kumar/OneDrive/UNOmaha/Study/Sem 3/ISQA 8086 - 2/NY Botanical Garden/1 - Work/DataSnipers/Deliverables/5 RScript")
as_plants <- read.csv("additionalspecies 2011-2016.csv", na.strings = "#N/A")
gc_plants = read.csv("src/inventory/groundcover 2011-2016.csv", na.strings = "#N/A")
gc_plants <- na.omit(gc_plants)
gc_plants <- gc_plants[,-c(2,3)]
summary(gc_plants)
as_plants <- read.csv("src/inventory/additionalspecies 2011-2016.csv", na.strings = "#N/A")
as_plants <- na.omit(as_plants)
as_plants <- as_plants[,-c(2,3)]
summary(as_plants)
View(as_plants)
as_native_summary <- as_plants[as_plants$Native == 'y',]
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
group_by(Year) %>%
count(Native)
View(as_native_summary)
?count
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year)
as_summary <- as_native_summary %>%
left_join(as_non_native_summary) %>%
left_join(as_invasive_summary)
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year)
as_non_native_summary <- as_plants[as_plants$Non.native == 'y',] %>%
count(Year)
as_invasive_summary <- as_plants[as_plants$Invasive == 'y',] %>%
count(Year)
as_summary <- as_native_summary %>%
left_join(as_non_native_summary) %>%
left_join(as_invasive_summary)
View(as_summary)
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year, setNames('Year', 'Native'))
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year, setNames('n', 'Native'))
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year)
colnames(as_native_summary)[2] <- "native"
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year) %>%
colnames()[2] <- "native"
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year) %>%
colnames(as_native_summary)[2] <- "native"
colnames(as_non_native_summary)[2] <- "non_native"
as_non_native_summary <- as_plants[as_plants$Non.native == 'y',] %>%
count(Year)
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year) %>%
colnames(as_native_summary)[2] <- "native"
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year)
colnames(as_native_summary)[2] <- "native"
as_non_native_summary <- as_plants[as_plants$Non.native == 'y',] %>%
count(Year)
colnames(as_non_native_summary)[2] <- "non_native"
as_invasive_summary <- as_plants[as_plants$Invasive == 'y',] %>%
count(Year)
colnames(as_invasive_summary)[2] <- "invasive"
as_summary <- as_native_summary %>%
left_join(as_non_native_summary) %>%
left_join(as_invasive_summary)
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year)
colnames(as_native_summary)[2] <- "native"
as_non_native_summary <- as_plants[as_plants$Non.native == 'y',] %>%
count(Year)
colnames(as_non_native_summary)[2] <- "non_native"
as_invasive_summary <- as_plants[as_plants$Invasive == 'y',] %>%
count(Year)
colnames(as_invasive_summary)[2] <- "invasive"
as_summary <- as_native_summary %>%
left_join(as_non_native_summary) %>%
left_join(as_invasive_summary)
# Reshaping the dataframe
as_summary <- melt(gc_summary, id.vars = c("Year"))
colnames(as_summary)[2] <- "species_type"
colnames(as_summary)[3] <- "count"
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year)
colnames(as_native_summary)[2] <- "native"
as_non_native_summary <- as_plants[as_plants$Non.native == 'y',] %>%
count(Year)
colnames(as_non_native_summary)[2] <- "non_native"
as_invasive_summary <- as_plants[as_plants$Invasive == 'y',] %>%
count(Year)
colnames(as_invasive_summary)[2] <- "invasive"
as_summary <- as_native_summary %>%
left_join(as_non_native_summary) %>%
left_join(as_invasive_summary)
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year)
colnames(as_native_summary)[2] <- "native"
as_non_native_summary <- as_plants[as_plants$Non.native == 'y',] %>%
count(Year)
colnames(as_non_native_summary)[2] <- "non_native"
as_invasive_summary <- as_plants[as_plants$Invasive == 'y',] %>%
count(Year)
colnames(as_invasive_summary)[2] <- "invasive"
as_summary <- as_native_summary %>%
left_join(as_non_native_summary) %>%
left_join(as_invasive_summary)
# Reshaping the dataframe
as_summary <- melt(as_summary, id.vars = c("Year"))
colnames(as_summary)[2] <- "species_type"
colnames(as_summary)[3] <- "count"
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year)
colnames(as_native_summary)[2] <- "native"
as_non_native_summary <- as_plants[as_plants$Non.native == 'y',] %>%
count(Year)
colnames(as_non_native_summary)[2] <- "non_native"
as_invasive_summary <- as_plants[as_plants$Invasive == 'y',] %>%
count(Year)
colnames(as_invasive_summary)[2] <- "invasive"
as_summary <- as_native_summary %>%
left_join(as_non_native_summary) %>%
left_join(as_invasive_summary)
# Reshaping the dataframe
as_summary <- melt(as_summary, id.vars = c("Year"))
colnames(as_summary)[2] <- "species_type"
colnames(as_summary)[3] <- "count"
as_summary %>%
ggplot(aes(x=Year, y=count, color=species_type)) +
geom_line(size=1) +
geom_point(size=2) +
labs(y= "Ground Cover in meters", title = "Count by Species Type")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(reshape2)
library(ggplot2)
library("RColorBrewer", lib.loc="~/R/win-library/3.4")
library(lubridate)
library(readxl)
cst <- read.csv("src/Comprehensive Species Tally 1937-2016.csv", na.strings = "na")
cst <- cst[,-c(2,3,4,6,7,8)]
head(cst)
cst$Survey.Year <- factor(cst$Survey.Year)
summary(cst)
#Create sub-tables
cst_1937 <- subset(cst, cst$Survey.Year==1937)
cst_2002 <- subset(cst, cst$Survey.Year==2002)
cst_2006 <- subset(cst, cst$Survey.Year==2006)
cst_2011 <- subset(cst, cst$Survey.Year==2011)
cst_2016 <- subset(cst, cst$Survey.Year==2016)
# Create vectors for all the years and species -> native, not-native and invasive
#year <- c('1937-01-01', '2002-01-01', '2006-01-01', '2011-01-01', '2016-01-01')
#year <- as.Date(year)
year <- c(1937, 2002, 2006, 2011, 2016)
native <- c(length(which(cst_1937$Native=='y')), length(which(cst_2002$Native=='y')), length(which(cst_2006$Native=='y')), length(which(cst_2011$Native=='y')), length(which(cst_2016$Native=='y')))
non_native <- c(length(which(cst_1937$Non.native=='y')), length(which(cst_2002$Non.native=='y')), length(which(cst_2006$Non.native=='y')), length(which(cst_2011$Non.native=='y')), length(which(cst_2016$Non.native=='y')))
invasive <- c(length(which(cst_1937$Invasive=='y')), length(which(cst_2002$Invasive=='y')), length(which(cst_2006$Invasive=='y')), length(which(cst_2011$Invasive=='y')), length(which(cst_2016$Invasive=='y')))
#Create dataframe with the vectors
cst_trend <- data.frame(year, native, non_native, invasive, stringsAsFactors = FALSE)
head(cst_trend)
#Reshaping the dataframe
cst_trendL <- melt(cst_trend, id.vars = c("year"))
colnames(cst_trendL)[2] <- "type"
colnames(cst_trendL)[3] <- "count"
#Plotting the dataset
line <- ggplot(cst_trendL, aes(x = year, y = count, color = type)) + geom_line(size=1) + geom_point(size=2)+ ggtitle("Species Types Count from 1937 to 2016") + labs(x="Years", y="Number of different Species")
line <- line + theme_bw()
line
cst_trendL [year != 1937,]%>%
ggplot(aes(x = year, y = count, color = type)) +
geom_line(size=1) +
geom_point(size=2) +
ggtitle("Species Count from 2002 to 2016") + labs(x="Years", y="Species Count") +
theme_bw()
cst_div <- cst %>%
mutate(species_type = case_when(Native=='y' ~ 'Native',
(Non.native=='y' & Invasive=='n') ~ 'Non-native/Non-invasive',
(Non.native=='y' & Invasive=='y') ~ 'Non-native/Invasive',
TRUE ~ 'Uncategorized'))
cst_div <- cst_div[,-c(3,4,5)]
cst_div <- subset(cst_div, species_type!='Uncategorized')
cst_div$species_type <- factor(cst_div$species_type)
#Creating new dataframe with species type count
species_type_count <- cst_div %>%
count(Survey.Year, species_type)
species_type_count
par(mar=c(0, 0, 2, 0), oma=c(0,0,2,0), mfrow=c(2,2))
#Creating the pie for the year 2002
for(i in levels(species_type_count$Survey.Year)){
if(i=='1937'){
next
}
count_i <- species_type_count[species_type_count$Survey.Year == i,-c(1)]
slices <- count_i$n
labels <-  count_i$species_type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main=paste("Percentage of species type in ", i), col=brewer.pal(length(labels),"Pastel1"))
}
woody_plants = read.csv("src/inventory/woodyplant 1937-2016.csv", na.strings = "#N/A")
woody_plants <- na.omit(woody_plants)
woody_plants <- woody_plants[,-c(2,3)]
woody_plants_1937 <- subset(woody_plants, woody_plants$Year==1937)
woody_plants_2002 <- subset(woody_plants, woody_plants$Year==2002)
woody_plants_2006 <- subset(woody_plants, woody_plants$Year==2006)
woody_plants_2011 <- subset(woody_plants, woody_plants$Year==2011)
woody_plants_2016 <- subset(woody_plants, woody_plants$Year==2016)
# Create vectors for all the years and species -> native, not-native and invasive
#year <- c('1937-01-01', '2002-01-01', '2006-01-01', '2011-01-01', '2016-01-01')
#year <- as.Date(year)
year <- c(1937, 2002, 2006, 2011, 2016)
native <- c(length(which(woody_plants_1937$Native=='y')), length(which(woody_plants_2002$Native=='y')), length(which(woody_plants_2006$Native=='y')), length(which(woody_plants_2011$Native=='y')), length(which(woody_plants_2016$Native=='y')))
non_native <- c(length(which(woody_plants_1937$Non.native=='y')), length(which(woody_plants_2002$Non.native=='y')), length(which(woody_plants_2006$Non.native=='y')), length(which(woody_plants_2011$Non.native=='y')), length(which(woody_plants_2016$Non.native=='y')))
invasive <- c(length(which(woody_plants_1937$Invasive=='y')), length(which(woody_plants_2002$Invasive=='y')), length(which(woody_plants_2006$Invasive=='y')), length(which(woody_plants_2011$Invasive=='y')), length(which(woody_plants_2016$Invasive=='y')))
#Create dataframe with the vectors
woody_plants_trend <- data.frame(year, native, non_native, invasive, stringsAsFactors = FALSE)
head(woody_plants_trend)
woody_plants_trendL <- melt(woody_plants_trend, id.vars = c("year"))
colnames(woody_plants_trendL)[2] <- "type"
colnames(woody_plants_trendL)[3] <- "count"
woody_plants_trendL[year != 1937,] %>%
ggplot(aes(x = year, y = count, color = type)) +
geom_line(size=1) + geom_point(size=2) +
ggtitle("Woody Plants Count from 2002 to 2016") + labs(x="Years", y="Count") +
theme_bw()
gc_plants = read.csv("src/inventory/groundcover 2011-2016.csv", na.strings = "#N/A")
gc_plants <- na.omit(gc_plants)
gc_plants <- gc_plants[,-c(2,3)]
summary(gc_plants)
gc_native_summary <- gc_plants[gc_plants$Native == 'y',] %>%
group_by(Year) %>%
summarise(native = sum(Sum.of.Cover..cm.)) %>%
arrange(desc(native))
gc_non_native_summary <- gc_plants[gc_plants$Non.native == 'y',] %>%
group_by(Year) %>%
summarise(non_native = sum(Sum.of.Cover..cm.)) %>%
arrange(desc(non_native))
gc_invasive_summary <- gc_plants[gc_plants$Invasive == 'y',] %>%
group_by(Year) %>%
summarise(invasive = sum(Sum.of.Cover..cm.)) %>%
arrange(desc(invasive))
#Left joining the above three
gc_summary <- gc_native_summary %>%
left_join(gc_non_native_summary) %>%
left_join(gc_invasive_summary)
#Reshaping the dataframe for a more plot friendly form
gc_summary <- melt(gc_summary, id.vars = c("Year"))
colnames(gc_summary)[2] <- "species_type"
colnames(gc_summary)[3] <- "ground_cover"
gc_summary$ground_cover <- gc_summary$ground_cover/100
#Plotting the above using line chart
gc_summary %>%
ggplot(aes(x=Year, y=ground_cover, color=species_type)) +
geom_line(size=1) +
geom_point(size=2) +
labs(y= "Ground Cover in meters", title = "Ground Cover by Species Type")
as_plants <- read.csv("src/inventory/additionalspecies 2011-2016.csv", na.strings = "#N/A")
as_plants <- na.omit(as_plants)
as_plants <- as_plants[,-c(2,3)]
summary(as_plants)
as_native_summary <- as_plants[as_plants$Native == 'y',] %>%
count(Year)
colnames(as_native_summary)[2] <- "native"
as_non_native_summary <- as_plants[as_plants$Non.native == 'y',] %>%
count(Year)
colnames(as_non_native_summary)[2] <- "non_native"
as_invasive_summary <- as_plants[as_plants$Invasive == 'y',] %>%
count(Year)
colnames(as_invasive_summary)[2] <- "invasive"
as_summary <- as_native_summary %>%
left_join(as_non_native_summary) %>%
left_join(as_invasive_summary)
# Reshaping the dataframe
as_summary <- melt(as_summary, id.vars = c("Year"))
colnames(as_summary)[2] <- "species_type"
colnames(as_summary)[3] <- "count"
as_summary %>%
ggplot(aes(x=Year, y=count, color=species_type)) +
geom_line(size=1) +
geom_point(size=2) +
labs(y= "Ground Cover in meters", title = "Count by Species Type")
work_hours <- read.csv("src/forest mgmt hours.csv")
work_hours <- work_hours[,c(2,4,5)]
#Reshaping
work_hours2 <- melt(work_hours, id.vars = c("year"))
colnames(work_hours2)[2] <- "employee_type"
colnames(work_hours2)[3] <- "hours"
# Summarising Invasive Plant Management
work_hours_summary <- work_hours2 %>%
group_by(year, employee_type) %>%
summarise(hours = sum(hours))
work_hours_summary %>%
ggplot(aes(x=year, y=hours, fill = employee_type)) +
geom_bar(stat = "identity")
restoration <- read.csv("src/NYBG Forest Restoration Plantings 2007-2018.csv", stringsAsFactors = FALSE)
restoration <- restoration[,-c(1,5,6,7,9)]
attach(restoration)
# Modifying the Data Types
restoration$Date.Planted <- as.Date(Date.Planted, "%m/%d/%Y")
restoration$Plant.Type <- as.factor(Plant.Type)
head(restoration)
summary(restoration)
#Total plants planted
sum(Qty)
#Total plants planted by Type
res_qty_type <- restoration %>%
group_by(Plant.Type) %>%
summarise(Qty = sum(Qty))
res_qty_type
# Pie Chart for the plants planted by Type
slices <- res_qty_type$Qty
labels <-  res_qty_type$Plant.Type
percent <- round(slices/sum(slices)*100, digits = 2)
labels <- paste(labels, percent)
labels <- paste(labels, "%", sep="")
pie(slices, labels, main="Plant types planted", col=brewer.pal(length(labels),"Pastel1"))
#Adding a column for the year
restoration <- restoration %>%
mutate(year_planted = year(restoration$Date.Planted))
#Adding a column for the month
restoration <- restoration %>%
mutate(month_planted = month(restoration$Date.Planted))
#Summarising number of plants planted by years
res_qty_year <- restoration %>%
group_by(year_planted) %>%
summarise(Qty = sum(Qty))
plot_qty_year <- ggplot(res_qty_year, aes(x=res_qty_year$year_planted, y=res_qty_year$Qty)) + geom_bar(stat = "identity", fill = "#2987bb") +
geom_text(y=res_qty_year$Qty+300 , label = res_qty_year$Qty) +
ggtitle("Restoration Planting by Years") + labs(x="Years", y="Plants planted") +
theme_bw()
plot_qty_year
boxplot(res_qty_year$Qty, main = "Plants planted by years", xlab="Quantity", col = "#ec8a71")
quantile(res_qty_year$Qty)
#Plantation by month and year
res_month <- restoration %>%
group_by(year_planted, month_planted) %>%
summarise(Qty = sum(Qty))
#Adding a dummy month column for X Label
res_month <- res_month %>%
mutate(month2_planted = as.Date(paste0("2000-", month_planted, "-01"), "%Y-%m-%d"))
#Plotting the new dataset
res_month %>%
ggplot(aes(x=month2_planted, y=Qty)) +
geom_bar(stat = "identity", fill = "darkorchid4") +
facet_wrap(~year_planted, ncol = 3) +
labs(title="Plantations by Months/Year", x="Month", y="Quantity planted")+
theme_bw(base_size = 10) + scale_x_date(date_labels = "%b")
# Removing duplicates from Comprehensive Speices Tally
cst_dedup <- cst[!duplicated(cst$Taxon),]
# Left Joining Restoration Data with Comprehensive Species Tally
res_by_species <- restoration %>%
left_join(cst_dedup)
res_by_species <- na.omit(res_by_species)
summary(res_by_species)
res_native <- res_by_species[, c(1, 5)]
# Summarizing by year
res_native_by_year <- res_native %>%
group_by(year_planted) %>%
summarise(qty_planted = sum(Qty))
#Plotting
res_native_by_year[res_native_by_year$year_planted<2017,] %>%
ggplot(aes(x=year_planted, y=qty_planted)) +
geom_bar(stat = "identity", fill = "darkorchid4")
woodyplants <- read_xlsx("src/Combined Woody Plants Data (2002,2006,2011,2016).xlsx")
groundcover <- read.csv("src/Combined Groundcover2011_2016.csv", stringsAsFactors = FALSE)
head(woodyplants)
tail(woodyplants)
str(woodyplants)
summary(woodyplants)
head(groundcover)
tail(groundcover)
str(groundcover)
summary(groundcover)
##forestmgmt <- read_xls("NYBG Forest Management_11052008 to 12312014.xls")
## First We are checking if there are any missing year column which is the first column on the datasets
sum(is.na(woodyplants$Year))
sum(is.na(groundcover$Sample.Date))
## Removing the empty rows
woodyplants <- woodyplants[rowSums(is.na(woodyplants)) < 7,]
groundcover <- groundcover[rowSums(is.na(groundcover)) < 10,]
woodyplants$`Transect Number` <- as.factor(woodyplants$`Transect Number`)
woodyplants$`Plot Number` <- as.factor(woodyplants$`Plot Number`)
groundcover$Transect.Number <- as.factor(groundcover$Transect.Number)
groundcover$Plot.Number <- as.factor(groundcover$Plot.Number)
groundcover$Sample.Date <- as.Date(groundcover$Sample.Date, format = "%m/%d/%Y")
#Set all the values in Genus to uppercases
woodyplants$Genus <- toupper(woodyplants$Genus)
library(dplyr)
#Get top 7 Genus
top_7 <- woodyplants %>% count(Genus) %>% arrange(desc(n)) %>% filter(n > 1000)
#Create a vector with top 7 Genus
target <- c("PRUNUS","DEAD","LINDERA","ACER","ARALIA","FAGUS","VIBURNUM")
#Get top 7 Genus with Year
top_7_year <- woodyplants %>% count(Year,Genus) %>% arrange(desc(n)) %>% filter(Genus %in% target )
#Create plots
library(ggplot2)
ggplot(top_7_year, aes(x = Genus, y = n, fill = factor(Year)), position ="dodge") + geom_bar(stat = "identity")
ggplot(top_7_year, aes(x = Genus, y = n, fill = factor(Year)), position ="dodge") + geom_bar(stat = "identity", position = "dodge")
